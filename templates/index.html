<!DOCTYPE html>
<html>
    <head>
		<meta charset="utf-8" /></meta>
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=1.0" />
		<title> HomeWork1</title>
		<style type="text/css">
		.head{
			background:linear-gradient(135deg, #AADDEE 0%, #66AABB 100%);
			color:black;
			font-weight:bold;
			font-size:40px;
			text-align:center;			
			height:320px;			
			line-height:300px;
						
		}
		.content{
			width:1200px;
			margin-left:auto;
			margin-right:auto;
		}
		.box{
			width:250px;			
			
			margin:15px;
			display:flex;
			flex-direction: column;
			verticcal-align:top;			
			
			float: left;
			
			border:1px solid #E8E8E8;
			border-radius:5px;
			box-sizing: border-box;
		}
		.site{
			float:right;
			
			
		}
		.text{
			font-size:16px;
			color: #757575;
			font-weight: bold;
			line-height: 13px;			
			padding-top:10px;
			padding-bottom:10px;
			padding-left:10px;
		}
		.img{
			display: block;
			weight:100%;
			height:75%;
			
			border-top-left-radius:5px;
			border-top-right-radius:5px;
			
		}
		.menu{
			float: right;
			margin: 0px;	
		}
		.menu li{
			float: left;
			display: block;			
		}
		.menu li a{
			color:black;
			text-decoration: none;
			display:inline;
		}
		.showmenu{
			display:none;
		}
		.view{
			display:flex;
			justify-content:center;
			flex-wrap:wrap;
			margin-top:20px;
		}
		.title{
			margin:10px 0px;
			color:#448899;
			font-size:30px;
			font-weight:bold;
			line-height:34px;
		}
		.titleall{
			display: flex;
			margin-left: 14%;
			margin-right: 15%;
		}
		.mintitle1{
			margin-top: 20px;
			color:#666666;
			font-size:16px;			
			line-height:13px;
			position:relative;
			left:63%;
		}
		.mintitle2{
			margin:10px 0px;
			color:#666666;
			font-size:16px;			
			line-height:13px;
			position:relative;
			left:52%;
		}
		.introduction1{			
			color:#F8F8F8;
			top:85px;	
			font-weight:bold;
			font-size:28px;
			line-height:24px;
			text-align:left;
			width:1200px;
			margin-left:auto;
			margin-right:auto;
			position:relative;	
		}
		.introduction2{			
			color:#F8F8F8;
			top:100px;
			font-weight:bold;
			font-size:16px;
			line-height:13px;
			text-align:left;
			width:1200px;
			margin-left:auto;
			margin-right:auto;
			position:relative;
		}
		.introduction3{			
			color:#FFFFFF;
			
			
			text-align:left;
			width:1200px;
			margin-left:auto;
			margin-right:auto;
			position:relative;
			
			
		}
		.inputtxt{
			width:400px;
			height:46px;
			font-size:16px;
			font-weight: bold;
			line-height:13px;
			color:#757575;
			border-top-left-radius: 5px;
			border-bottom-left-radius: 5px;
			border: none;
			
			
		}
		.search-btn {
			width: 60px;
			height: 49px;
			background-color: #448899;
			position: relative;
			right: 10px;
			top: 8px;
			border-top-right-radius: 5px;
			border-bottom-right-radius: 5px;
			border: none;
		}
		.img1{
			width:650px;
			height:320px;
		}
		.introduction4{	
			width:650px;
			height:320px;
			margin-left:auto;
			margin-right:auto;
			position:relative;
			bottom:336px;
			left:20%;
		}	
		.td1{
			padding-left:10px;
			font-size: 16px;
			line-height: 13px;
			color: #757575;
		}
		.td2{
			text-align:right;
			font-size: 16px;
			line-height: 13px;
			color: #757575;
			padding-right:10px;
			
		}
		.bottommsg{
			background: #757575;
			height:104px;
			color:#FFFFFF;
			font-weight: bold;
			font-size: 16px;
			line-height: 13px;
			text-align:center;
			margin-top: 30px;
		}		
		.bottommsg2{	
			position: relative;    
			top: 50%;
		}
		.outside{
			margin-left:110px;
			z-index: 1;
			position: relative;
		}
		
		
		@media screen and (max-width:600px){
			.head{
				font-size:40px;
			}
			.content{
				width:90%;
				/*text-align:center;*/
			}
			ul{
				display: none;
			}
			label{
				display: block;
			}
			#burger:checked + ul{
				display:block;
			}
			.showmenu{
				display: block;
				float: right;
				
			}		
			.menu {       
				display: none; 
				margin-top: 0;
				padding-left: 0;
				position: fixed;
				right: 0;
				top: 40px;
				width: 60px;
				height: 100%;
			}
			.menu li{
				float: none;
		
			}
			.menu li a{
				transition: all 0.3s;
			}	
			.box{
				width:90%;
				height: 90%;
			}
			.title{
				margin-left: 10%;
				white-space: nowrap;
			}
			.inputtxt{
				width:200px;
			}
			.mintitle1{
				left:10%;
				white-space:nowrap;
			}
			.titleall{
				margin-left:0%;
			}
			.introduction1{
				width:290px;
			}
			.introduction2{
				width:290px;
			}
			.introduction3{
				width:290px;
			}
			.introduction4{
				width:275px;
				height: 150px;
				bottom: 180px;
				left: 35px;
			}
			.img1{
				width:200px;
				height:100px;
			}
			.outside{
				margin-left: 20px;
			}
						
		}
		@media screen and (min-width:601px) and (max-width:1200px){
			.head{
				font-size:40px;
			}
			.content{
				width:90%;
				/*text-align:center;*/
			}
			.box{
				width:35%;
			}
		}
		
		
		</style>
		<script type="text/javascript">

		var nextpage;		
		var getdata = false;
		window.onload =function() {
		
			let req=new XMLHttpRequest();
			req.open("get", "/api/attractions");
			req.onload=function(){
			//debugger;
				var jsonObj = JSON.parse(this.responseText);
				var value = jsonObj["data"];
				console.log(value)
				var stitle;
				var pic;
				var pic_new;
				var mrt;
				var cat2;
				nextpage=jsonObj["nextPage"];
				for(var i=0; i<12; i++){
					stitle=value[i]["name"];
					mrt=value[i]["mrt"];
					cat2=value[i]["category"];
					pic=value[i]["images"][0].split(',');
					pic_new=pic[0];
					
					var bigdiv= document.getElementById("div1");
					
					var boxdiv= document.createElement("div");
					boxdiv.className="box";
					bigdiv.appendChild(boxdiv);
					
					var image=document.createElement("img");
					image.className="img";
					image.setAttribute("src", pic_new);
					boxdiv.appendChild(image);
					
					var adddiv2=document.createElement("div");
					adddiv2.className= "text";
					boxdiv.appendChild(adddiv2);
					var div2txt= document.createTextNode(stitle);
					adddiv2.appendChild(div2txt);
					
					var adddiv3=document.createElement("div");
					var table = document.createElement("table");
					var tr = document.createElement("tr");
					var td1 = document.createElement("td");
					var td2 = document.createElement("td");
					var td1txt= document.createTextNode(mrt);
					var td2txt= document.createTextNode(cat2);
					tr.appendChild(td1);
					td1.className= "td1"
					td1.appendChild(td1txt);
					tr.appendChild(td2);
					td2.className= "td2"
					td2.appendChild(td2txt);
					table.style= "width:100%;"
					table.appendChild(tr);
					adddiv3.appendChild(table);
					boxdiv.appendChild(adddiv3);
				}				
			};
			req.send();//送出連線
		}
		
		function keyword(keyw){
			var a = document.getElementById("div1");
			a.innerHTML = "";
			let req=new XMLHttpRequest();
			req.open("get", "/api/attractions?page=0&keyword=" + keyw);
			req.onload=function(){
			//debugger;
				var jsonObj = JSON.parse(this.responseText);
				var value = jsonObj["data"];
				console.log(value)
				var stitle;
				var pic;
				var pic_new;
				var mrt;
				var cat2;
				nextpage=jsonObj["nextPage"];
				if(Object.keys(jsonObj)[0] != "error"){
					document.getElementById("divnone").style.display="none"
					for(var i=0; i<12; i++){
						stitle=value[i]["name"];
						mrt=value[i]["mrt"];
						cat2=value[i]["category"];
						pic=value[i]["images"][0].split(',');
						pic_new=pic[0];
						
						var bigdiv= document.getElementById("div1");
						
						var boxdiv= document.createElement("div");
						boxdiv.className="box";
						bigdiv.appendChild(boxdiv);
						
						var image=document.createElement("img");
						image.className="img";
						image.setAttribute("src", pic_new);
						boxdiv.appendChild(image);
						
						var adddiv2=document.createElement("div");
						adddiv2.className= "text";
						boxdiv.appendChild(adddiv2);
						var div2txt= document.createTextNode(stitle);
						adddiv2.appendChild(div2txt);
						
						var adddiv3=document.createElement("div");
						var table = document.createElement("table");
						var tr = document.createElement("tr");
						var td1 = document.createElement("td");
						var td2 = document.createElement("td");
						var td1txt= document.createTextNode(mrt);
						var td2txt= document.createTextNode(cat2);
						tr.appendChild(td1);
						td1.className= "td1"
						td1.appendChild(td1txt);
						tr.appendChild(td2);
						td2.className= "td2"
						td2.appendChild(td2txt);
						table.style= "width:100%;"
						table.appendChild(tr);
						adddiv3.appendChild(table);
						boxdiv.appendChild(adddiv3);
					}
				}
				else{
					div1.innerHTML = "";
					document.getElementById("divnone").style.display="block"
				}
			};
			req.send();//送出連線
		}


		//const container = document.querySelector(".div1")

		function loadimage(keyw, page){
			getdata = true;//判斷滾輪是否重複load
			
			let req=new XMLHttpRequest();
			req.open("get", "/api/attractions?page=" + page + "&keyword=" + keyw);
			req.onload=function(){
			//debugger;
				var jsonObj = JSON.parse(this.responseText);
				var value = jsonObj["data"];
				console.log(value)
				var stitle;
				var pic;
				var pic_new;
				var mrt;
				var cat2;
				nextpage=jsonObj["nextPage"];
				if(Object.keys(jsonObj)[0] != "error"){
					document.getElementById("divnone").style.display="none"
					for(var i=0; i<12; i++){
						stitle=value[i]["name"];
						mrt=value[i]["mrt"];
						cat2=value[i]["category"];
						pic=value[i]["images"][0].split(',');
						pic_new=pic[0];
						
						var bigdiv= document.getElementById("div1");
						
						var boxdiv= document.createElement("div");
						boxdiv.className="box";
						bigdiv.appendChild(boxdiv);
						
						var image=document.createElement("img");
						image.className="img";
						image.setAttribute("src", pic_new);
						boxdiv.appendChild(image);
						
						var adddiv2=document.createElement("div");
						adddiv2.className= "text";
						boxdiv.appendChild(adddiv2);
						var div2txt= document.createTextNode(stitle);
						adddiv2.appendChild(div2txt);
						
						var adddiv3=document.createElement("div");
						var table = document.createElement("table");
						var tr = document.createElement("tr");
						var td1 = document.createElement("td");
						var td2 = document.createElement("td");
						var td1txt= document.createTextNode(mrt);
						var td2txt= document.createTextNode(cat2);
						tr.appendChild(td1);
						td1.className= "td1"
						td1.appendChild(td1txt);
						tr.appendChild(td2);
						td2.className= "td2"
						td2.appendChild(td2txt);
						table.style= "width:100%;"
						table.appendChild(tr);
						adddiv3.appendChild(table);
						boxdiv.appendChild(adddiv3);
						getdata = false;
					}
				}	
				
			}
			req.send();//送出連線
			
			
		}
		
	
		window.addEventListener("scroll", ()=> {
			const { scrollTop, scrollHeight, clientHeight } = document.documentElement;
			let key = document.getElementById("keyw").value;
			if(clientHeight + scrollTop >= scrollHeight-1) {				
				if(nextpage != null && getdata == false){
					
					loadimage(key , nextpage)
				}
			}
		});


		</script>
	</head>
	<body style="margin:0px;" >
	<div class="titleall">
		<div class="title">
			<span >台北一日遊</span>
		</div>
		<div class="mintitle1">
			<span >預定行程</span>
			&nbsp
			<span>登入/註冊</span>
		</div>
		
	</div>
	<div class="head">
		<div class="outside">
			<div class="introduction1">輕鬆享受台北一日悠閒</div>		
			<div class="introduction2">探索每個角落，體驗城市的深度旅遊行程</div>
			<div class="introduction3">
				<input type="text" id="keyw" placeholder="輸入景點名稱查詢" class="inputtxt" style="padding-left:15px;"></input>
				<button class="search-btn" onclick="keyword(getElementById('keyw').value)">
					<img src="/icon_search.png">
				</button>
			</div>
		</div>
		<div class="introduction4">		
			<img src="/welcome 1.png" class="img1">
		</div>
	</div>
	
	<div class="content" >	
		<div class="view" id="div1"></div>
		<div id="divnone" style="display:none;">查無資料</div>
	</div>
	<div class="bottommsg">
		<span class="bottommsg2">COPYRIGHT © 2021 台北一日遊</span>
	</div>
	</body>
</html>